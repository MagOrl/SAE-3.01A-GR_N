CREATE TABLE
    HABILITATION (IdHab varchar(10) primary key, nomHab varchar(20));

CREATE TABLE
    PERSONNEL (
        IdPers varchar(10) primary key,
        nomPers varchar(20)
    );

CREATE TABLE
    PLATEFORME (
        IdPla varchar(10) primary key,
        nomPla varchar(20),
        nbPersNec int,
        coutExploiJ decimal(10, 2),
        interMainte int
    );

CREATE TABLE
    NECESSITER (
        IdHab varchar(10),
        IdPla varchar(10),
        primary key (IdHab, IdPla),
        foreign key (IdHab) references HABILITATION (IdHab),
        foreign key (IdPla) references PLATEFORME (IdPla)
    );

CREATE TABLE
    SPECIALISER_EN (
        IdHab varchar(10),
        IdPers varchar(10),
        primary key (IdHab, IdPers),
        foreign key (IdHab) references HABILITATION (IdHab),
        foreign key (IdPers) references PERSONNEL (IdPers)
    );

create TABLE
    CAMPAGNE (
        IdCamp varchar(10),
        IdPla varchar(10),
        nomLieuFouille varchar(20),
        duree float,
        jma date,
        primary key (IdCamp),
        foreign key (IdPla) references PLATEFORME (IdPla)
    );

CREATE TABLE
    PARTICIPER (
        IdPers varchar(10),
        IdCamp varchar(10),
        primary key (IdPers, IdCamp),
        foreign key (IdPers) references PERSONNEL (IdPers),
        foreign key (IdCamp) references CAMPAGNE (IdCamp)
    );

CREATE TABLE
    SEQUENCE (IdSeq varchar(10) primary key);

CREATE TABLE
    EXTRAIRE (
        IdSeq varchar(10),
        IdCamp varchar(10),
        primary key (IdCamp, IdSeq),
        foreign key (IdCamp) references CAMPAGNE (IdCamp),
        foreign key (IdSeq) references SEQUENCE (IdSeq)
    );

CREATE TABLE
    ESPECE (
        IdEsp varchar(10) primary key,
        IdSeq varchar(10),
        NomEsp varchar(40),
        foreign key (IdSeq) references SEQUENCE (IdSeq)
    );

CREATE TABLE
    ECHANTILLION (
        IdEch varchar(10) primary key,
        IdSeq varchar(10),
        commentaire varchar(255),
        foreign key (IdSeq) references SEQUENCE (IdSeq)
    );

delimiter |
CREATE OR REPLACE TRIGGER bonneAbilite 
BEFORE INSERT ON PARTICIPER FOR EACH ROW 
begin 
    IF (select IdHab from PERSONNEL natural join SPECIALISER_EN where IdPers = NEW.IdPers) == (select IdHab from CAMPAGNE natural join PLATEFORME natural join NECESSITER where IdPers = NEW.IdCamp)
    THEN 
        signal SQLSTATE '45000' set MESSAGE_TEXT = 'Pas la bonne habilit√© pour le personel.';
    END IF;
end |
delimiter ;